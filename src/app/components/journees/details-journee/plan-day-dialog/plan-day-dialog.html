<label class="text-2xl font-extrabold" mat-dialog-title>Planification de la journée {{data.reference}}</label>
<mat-dialog-content class="h-[500px] w-[700px]">
  <mat-stepper [linear]="true" #stepper>
    <mat-step label="Commandes à livrer" [completed]="canGoTo()">
        <div class="flex flex-col h-72 max overflow-y-auto">
          <div>
            <p class="text-lg font-base">
              Choisir les commandes à livrer
            </p>
          </div>
          <mat-checkbox class="mr-4 my-2"
                        color="primary"
                        (change)="onCheckAll($event.checked)">
                <div class="flex w-96 rounded-md font-extrabold uppercase py-4 px-4 shadow-md shadow-gray-300 hover:bg-slate-100">
                  Toutes les commandes
                </div>
          </mat-checkbox>
          @for(item of data.commandes; track $index) {
            <mat-checkbox class="mr-4 my-2"
                        color="primary"
                        [checked]="isSelected(item.reference)"
                        (change)="onCheck(item.reference, $event.checked)">
                <div class="flex flex-col w-96 rounded-md py-4 px-4 shadow-md shadow-gray-300 hover:bg-slate-100 justify-between">
                  <div class="text-sm font-semibold ">
                    Commande N° {{item.reference}}
                  </div>
                  <div class="text-xs font-medium ">
                    Lieu: {{ item.client.adresse }}
                  </div>
                  <div class="text-xs">
                    <label>
                      {{item.client.codePostal}}, {{ item.client.ville }}
                    </label>
                  </div>
                </div>
            </mat-checkbox>
          }
        </div>
        <div>
          {{commandeToDeliver().length}} / {{data.commandes.length}}
        </div>
        <div class="float-right mr-8">
          <button mat-button matStepperNext [disabled]="!canGoTo()">Suivant</button>
        </div>
    </mat-step>
    <mat-step label="Finalisation">
      <div class="flex flex-col mb-6">
        <div class="flex flex-col">
          <div>
            @if(nbTurns() == null) {
              <label class="block text-red-600 text-sm">ne peut être null</label>
            }
            <mat-form-field>
              <mat-label>Nombre de tournées</mat-label>
              <input matInput id="nbr-tournees"  
                            type="number"
                            min="0"
                            placeholder="Nombre de tournées"
                            [ngModel]="nbTurns()"
                            (ngModelChange)="updateNbTurns($event)"/>
            </mat-form-field>
          </div>
          <div class="flex flex-row">
            <img src="../../../../../assets/important.png" class="w-8 mr-4"/>
            <label class="font-medium text-sm">Le nombre de tournées doit être inférieur ou égal au nombre de commande à livrer</label>
          </div>
        </div>
      </div>
      
      <div>
        <button mat-button matStepperPrevious>Retour</button>
      </div>
    </mat-step>
  </mat-stepper>
</mat-dialog-content>
<mat-dialog-actions>
  <button mat-button (click)="onNoClick()">Annuler</button>
  <button
          [mat-dialog-close]="submitData()"
          [matTooltip]="disabledSubmitMsg()"
          matTooltipPosition = "right"
          [disabled]="!canSubmit()"
          class="bg-gray-800 text-white font-medium rounded-md p-2 disabled:bg-gray-100 disabled:text-gray-300 disabled:font-medium">
        Valider
  </button>
</mat-dialog-actions>
